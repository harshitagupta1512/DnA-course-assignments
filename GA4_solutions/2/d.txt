SELECT WORD, SUMSCORE/COUNTSCORE AS AVGSCORE FROM
(   
    SELECT SUM(SCORE) AS SUMSCORE, WORD, COUNT(SCORE) AS COUNTSCORE FROM
    (
        SELECT WORD, DOC_ID, FREQ/SUMFREQUENCY AS SCORE FROM
        (
            (
                SELECT SUM(FREQ) AS SUMFREQUENCY, DOC_ID AS AID FROM INVINDEX GROUP BY AID
            ) 
            AS A INNER JOIN
            (
                SELECT WORD, DOC_ID, FREQ FROM INVINDEX
            ) 
            AS B ON A.AID=B.DOC_ID
        )
    ) 
    GROUP BY WORD
) 
ORDER BY AVGSCORE DESC;
